YUI.add("np-models",function(e,t){function s(){this.publish("error",{defaultFn:this._defErrorFn})}var n=e.config.global.JSON,r=e.Lang,i=e.namespace("NPModel");s.prototype={apis:{},httpMethods:{},buildURL:function(e){return this.apis[e]},_defErrorFn:function(t){var n=t.options||{},r=n.errorFn||e.message;n.attrs&&this.undo(),r(t.error)},_onSyncIOSuccess:function(e,t,r){var i={};if(!r)return;try{i=n.parse(t.responseText)}catch(s){i={message:"\u8fd4\u56de\u6570\u636e\u683c\u5f0f\u9519\u8bef\uff01"}}i.message?r(i):r(null,i)},_onSyncIOFailure:function(e,t,r){var i;if(!r||!t.status)return;try{i=n.parse(t.responseText)}catch(s){i={message:t.responseText||t.statusText}}r(i.message)},sync:function(t,r,i){var s=this.httpMethods[t],o={},u;r||(r={}),o.Accept="application/json",s==="get"?o["If-Modified-Since"]="0":(r.attrs&&this.setAttrs(r.attrs),o["Content-Type"]="application/json",u=n.stringify(r.attrs));if(this._req&&this._req.isInProgress())return;this._req=e.io(this.buildURL(t,r),{method:s,headers:o,data:u,arguments:i,context:this,on:{success:this._onSyncIOSuccess,failure:this._onSyncIOFailure}})},parse:function(e){return e?e.data:null}},i.Sync=s,e.User=e.Base.create("user",e.Model,[s],{apis:{create:"/api/user"},httpMethods:{create:"post"}},{ATTRS:{name:{value:null},password:{value:null}}}),e.Audio=e.Base.create("audio",e.Model,[s],{},{ATTRS:{name:{value:null},author:{value:null},duration:{value:null},src:{value:null},lyric:{value:null},belong_album:{value:null}}}),e.Album=e.Base.create("album",e.Model,[s],{},{ATTRS:{name:{value:null},avatar:{value:null},audio_num:{value:null},audio_collection:{value:null}}})},"@VERSION@",{requires:["model","io-base","json-stringify"]});
